C51 COMPILER V9.54   MAIN                                                                  05/25/2020 10:34:23 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Spring Program Files(x86)\MDK4 and MDK5\C51\BIN\C51.EXE procedure\main.c LAR
                    -GE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(main.obj)

line level    source

   1          
   2          /*****************************************************************************************/
   3          //é¡¹ç›®åç§°ï¼šåºŸæ¶²æŠ½å–è®¾å¤‡
   4          //ç‰ˆ    æœ¬ï¼šXPCYV1.0
   5          //å­˜å‚¨è·¯å¾„ï¼šE:\å·¥ä½œ\MasterControl\5.7\MasterControl5.7\MAINCONTROLCSDV0826   
   6          //--------------------------------
   7          //ä½œè€…ï¼šXiong_Xiaoping 
   8          //ä¿®æ”¹æ—¥æœŸï¼š2020/05/07
   9          //ä¿®æ”¹å†…å®¹ï¼šå®Œæˆå¤„æ¬¡ç‰ˆæœ¬
  10          //----------------------------
  11          //ä½œè€…ï¼šXiong_Xiaoping 
  12          //ä¿®æ”¹æ—¥æœŸï¼š2020/05/12
  13          //ä¿®æ”¹å†…å®¹ï¼šä¿®æ”¹ç¬¬äº”ä¸€æ£€æµ‹æ¯ï¼Œå¯åŠ¨åæ— æ³•åœæ­¢ç­‰bug;
  14          //----------------------------
  15          //ä½œè€…ï¼šXiong_Xiaoping 
  16          //ä¿®æ”¹æ—¥æœŸï¼š2020/05/12
  17          //ä¿®æ”¹å†…å®¹ï¼šåˆ†ç‰ˆå—å¯¹æ•°æ®åšå¤„ç†;
  18          //----------------------------
  19          //OSC 11.0592MHz
  20          /*****************************************************************************************/
  21          
  22          //å¤´æ–‡ä»¶
  23          /*****************************************************************************************/
  24          #include  "config.h"
  25          #include  "timer.h"
  26          #include  "GPIO.h"
  27          #include  "USART1.h"
  28          #include  "eeprom.h"
  29          #include  "intrins.h"
  30          #include  "delay.h"
  31          #include  "CupDet.h"
  32          #include  "TaskUart.h"
  33          #include  "MasterControl.h"
  34          #include  "ResidueDegree.h"
  35          
  36          extern COMx_Define  COM1;
  37          extern  u8  RX1_Buffer [COM_RX1_Lenth]; //æ¥æ”¶ç¼“å†²
  38          extern T0_100MS2,T1_1MS1,T2_10MS2,MS3,T0_500MS2 ;  //å…¶ä»–æ–‡ä»¶å®šä¹‰çš„å˜é‡(å¤–éƒ¨å˜é‡)
  39          extern  u16 ScanCounter1, ScanCounter2, ScanCounter3, ScanCounter4, ScanCounter5,ExvalveCounter;//ä¼ æ„Ÿå™¨
             -æ ‡å¿—|è®¡æ•°å™¨
  40           
  41          //ä»»åŠ¡ä½¿èƒ½æ ‡å¿—åˆå§‹åŒ–
  42            u8 TaskUartFlag = 0;//ä»»åŠ¡1ï¼šæ•°æ®å¸§æ¥æ”¶è§£æä»»åŠ¡
  43            u8 TaskStateScanFlag = 0;//ä»»åŠ¡2ï¼šè®¾å¤‡çŠ¶æ€æ‰«ææ£€æµ‹ä»»åŠ¡
  44            u8 TaskUploadFlag = 0;//ä»»åŠ¡3ï¼šæ•°æ®ä¸Šä¼ ä»»åŠ¡
  45            u8 TaskEEPROMFlag = 0;//ä»»åŠ¡4ï¼šEEPROMè¯»å†™ä»»åŠ¡
  46            u8 TaskControlFlag = 0;//ä»»åŠ¡5ï¼šè®¾å¤‡è¿è¡Œæ§åˆ¶ä»»åŠ¡
  47            
  48          //ä¸¤ä¸ªæ•°æ®åŒºçš„å®šä¹‰å’Œåˆå§‹åŒ–ï¼Œæ¯ä¸ªä½ç½®çš„æ•°æ®å‚è€ƒæ€»åè®®æ–‡æ¡£è¡¨10ã€è¡¨11
  49          //u8 SlaveDataBuff[SDB_LEN];//æœ¬åœ°çŠ¶æ€æ•°æ®åŒº
  50          //u8 MasterDataBuff[MDB_LEN];//ä¸»æ§STM32ä¸‹å‘çš„æ•°æ®åŒº
  51          
  52          u8 SlaveDataBuff[SDB_LEN]={0} ;//æœ¬åœ°çŠ¶æ€æ•°æ®åŒº
  53          u8 MasterDataBuff[MDB_LEN]={0};//ä¸»æ§STM32ä¸‹å‘çš„æ•°æ®åŒº
C51 COMPILER V9.54   MAIN                                                                  05/25/2020 10:34:23 PAGE 2   

  54          
  55          
  56           u8 vt1;
  57          
  58          
  59          
  60          void main()
  61          {
  62   1          //u8 i;
  63   1          GPIO_config ();
  64   1          Timer_config();
  65   1          UART_config ();
  66   1          EA = 1;
  67   1          CupDetconfig();//è‡ªæ£€åˆå§‹åŒ–
  68   1         while(1)
  69   1        {
  70   2          
  71   2           PumpControl();
  72   2          if(TaskStateScanFlag) //500ms æ£€æµ‹ä¸€æ¬¡ ç¬¬ä¸€ä¸ªæ—¶é—´ç‰‡  //åŸºç¡€ä»»åŠ¡å…è®¸å·¥ä½œ
  73   2          { 
  74   3            TaskStateScanFlag=0; //æ¸…é™¤æ ‡å¿—ä½
  75   3            LED=~LED;//Twinkel
  76   3            ScanCounter1++;
  77   3            ScanCounter5++;
  78   3            ScanCounter3++;
  79   3            vt1++;
  80   3            CupDet(); //ä»æ¿æ¯å­”çŠ¶æ€æ§åˆ¶åŠå¤„ç†å‡½æ•°//å°†æ£€æµ‹çš„æ•°æ®æ›´æ–°ä¿å­˜åˆ°æœ¬åœ°çŠ¶æ€æ•°æ
             -®åŒº
  81   3      //      for(i=0;i<=30;i++)
  82   3      //            {
  83   3      //              UART_Send_Byte(MasterDataBuff[i]);//è°ƒè¯•ä¸²å£buffæ•°æ®
  84   3      //            } 
  85   3            
  86   3          }
  87   2          
  88   2          if(TaskUartFlag)//æ•°æ®è§£æä»»åŠ¡å…è®¸å·¥ä½œï¼Œè¯¥æ ‡å¿—ä½ç”±å®šæ—¶å™¨ä¸­æ–­æœåŠ¡å‡½æ•°ç½®ä½
  89   2          {
  90   3      
  91   3            TaskUartFlag = 0;//æ¸…é™¤æ ‡å¿—ä½
  92   3            if(DataValidityCheck(RX1_Buffer) == 0)//æ ¡éªŒæˆåŠŸ
  93   3            DataAnalyze(RX1_Buffer);//è§£ææ•°æ®
  94   3             state=0;
  95   3          }
  96   2          
  97   2        
  98   2        if(T0_500MS2)
  99   2        {
 100   3          T0_500MS2=0;
 101   3          vt1++;
 102   3          if(TaskEEPROMFlag != 0)//EEPROMä»»åŠ¡å…è®¸å·¥ä½œ
 103   3            {
 104   4              MasterControlEE();//å‰©ä½™æ¬¡æ•°å†™å…¥å‡½æ•°//ç›´æ¥å†™EEPROM,åŒæ—¶æ›´æ–°æœ¬åœ°çŠ¶æ€æ•°æ®åŒºçš„å†…å
             -®¹
 105   4              TaskEEPROMFlag = 0;//æ¸…é™¤æ ‡å¿—ä½
 106   4            
 107   4            }
 108   3      
 109   3          if(TaskControlFlag != 0)//æ§åˆ¶ä»»åŠ¡å…è®¸å·¥ä½œ
 110   3          {
 111   4            MasterControl();//æ§åˆ¶å‡½æ•°//è¯»å–æŒ‡ä»¤æ•°æ®åŒºçš„å†…å®¹ï¼Œæ ¹æ®æ•°æ®å®Œæˆå¯¹å„è®¾å¤‡çš„æ§åˆ
             -¶
 112   4            TaskControlFlag = 0;//æ¸…é™¤æ ‡å¿—ä½
C51 COMPILER V9.54   MAIN                                                                  05/25/2020 10:34:23 PAGE 3   

 113   4          }       
 114   3        } 
 115   2          if(TaskUploadFlag!=0)//ä¸Šä¼ çŠ¶æ€ä»»åŠ¡å…è®¸å·¥ä½œ
 116   2          {
 117   3      //      if(TaskUploadFlag==1)
 118   3      //      {       //è§£æå®Œæˆåï¼Œç›´æ¥å‘é€çŠ¶æ€æ•°æ®åŒºçš„æ‰€æœ‰å†…å®¹ï¼Œæˆ–è¯»å–çŠ¶æ€æ•°æ®åŒºåªå‘é
             -€æ¬¡æ•°å†…å®¹
 119   3            FramePacking(0x71,SlaveDataBuff);
 120   3            TaskUploadFlag = 0;//æ¸…é™¤æ ‡å¿—ä½
 121   3      //      }
 122   3      //      else if(TaskUploadFlag==2)
 123   3      //      {
 124   3      //       FramePacking(0x71,SlaveDataBuff);
 125   3      //      TaskUploadFlag = 0;//æ¸…é™¤æ ‡å¿—ä½
 126   3      //      }
 127   3      //      else if((TaskUploadFlag==3)&&(MasterDataBuff[20]!=0))
 128   3      //      {
 129   3      //        
 130   3      //        if(vt1>=((u8)(MasterDataBuff[20])))
 131   3      //        {
 132   3      //        vt1=0;
 133   3      //        FramePacking(0x71,SlaveDataBuff);
 134   3      //        }
 135   3      //      }
 136   3      //      TaskUploadFlag = 0;//æ¸…é™¤æ ‡å¿—ä½
 137   3          }
 138   2        
 139   2        }
 140   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    191    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     63    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
